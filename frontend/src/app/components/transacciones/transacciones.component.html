<div class="container-fluid py-2">
    <div class="row justify-content-evenly">
        <div class="col-8 card my-5 p-5">
            <h2 class="text-center mb-2">Transacciones</h2>
            <div class="text-end mb-4">
                <button (click)="llamarFormAgregarTransaccion()" type="submit" class="btn btn-coral mt-3">
                    <i class="bi bi-plus-circle me-3"></i>Agregar Transacción
                </button>
            </div>
            <table datatable class="table table-striped table-bordered" [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
                <thead>
                    <tr class="align-text-middle">
                        <th>ID</th>
                        <th>Moneda Origen</th>
                        <th>Cantidad Origen</th>
                        <th>Moneda Destino</th>
                        <th>Cantidad Destino</th>
                        <th>Email</th>
                        <th>Tasa de Conversión</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of transacciones">
                        <td>{{item._id}}</td>
                        <td>{{item.monedaOrigen}}</td>
                        <td>{{item.cantidadOrigen | currency: item.monedaOrigen}}</td>
                        <td>{{item.monedaDestino}}</td>
                        <td>{{item.cantidadDestino | currency: item.monedaDestino}}</td>
                        <td>{{item.emailCliente}}</td>
                        <td>{{item.tasaConversion}}</td>
                    </tr>
                </tbody>
                <tfoot>
                </tfoot>
            </table>

        </div>
        <form #consultaForm="ngForm" class="col-3 card my-5 p-5">
            <h2 class="text-center mb-4">Filtros</h2>
            <div class="mb-3">
                <label for="origen" class="form-label">Moneda Origen</label>
                <select id="origen" class="form-select form-control" [(ngModel)]="origen" name="origen" required #from="ngModel"
                [ngClass]="{'border-danger': from.invalid && (from.dirty || from.touched)}">
                    <option *ngFor="let divisa of divisas" [ngValue]="divisa">{{ divisa }}</option>
                </select>
                <div *ngIf="from.invalid && (from.dirty || from.touched) && from.errors?.['required']" class="form-text text-danger">
                    <i class="bi bi-exclamation-circle"></i> Seleccione divisa.
                </div>
            </div>
            
            <div class="mb-3">
                <label for="destino" class="form-label ">Moneda Destino</label>
                <select id="destino" class="form-select form-control" [(ngModel)]="destino" name="destino" required #to="ngModel"
                [ngClass]="{'border-danger': to.invalid && (to.dirty || to.touched)}">
                    <option *ngFor="let divisa of divisas" [ngValue]="divisa">{{ divisa }}</option>
                </select>
                <div *ngIf="to.invalid && (to.dirty || to.touched) && to.errors?.['required']" class="form-text text-danger">
                    <i class="bi bi-exclamation-circle"></i> Seleccione divisa.
                </div>
            </div>
            
            <button [disabled]="!consultaForm.form.valid" (click)="obtenerTransaccionesPorMoneda()" type="submit" class="btn btn-azul mt-3">Aplicar filtro</button>
            <button (click)="cargarTransacciones()" type="submit" class="btn btn-coral mt-3">Quitar filtro</button>
        </form>
    </div>
</div>